name: Build and Test

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Validate HTML files
      run: |
        echo "🔍 Validating HTML structure..."
        find . -name "*.html" -type f | head -5
        echo "✅ HTML files found and accessible"
    
    - name: Validate CSS files
      run: |
        echo "🎨 Validating CSS structure..."
        find . -name "*.css" -type f | head -5
        echo "✅ CSS files found and accessible"
    
    - name: Validate JavaScript files
      run: |
        echo "⚡ Validating JavaScript structure..."
        find . -name "*.js" -type f | head -5
        echo "✅ JavaScript files found and accessible"
    
    - name: Check project structure
      run: |
        echo "� Project structure:"
        ls -la
        echo ""
        echo "📂 Frontend structure:"
        ls -la frontend/ || echo "Frontend directory not found"
        echo ""
        echo "✅ Project structure validated"
    
    - name: Verify documentation
      run: |
        echo "📖 Checking documentation..."
        [ -f README.md ] && echo "✅ README.md exists" || echo "❌ README.md missing"
        [ -f PROJECT-STRUCTURE.md ] && echo "✅ PROJECT-STRUCTURE.md exists" || echo "❌ PROJECT-STRUCTURE.md missing"
        [ -f package.json ] && echo "✅ package.json exists" || echo "❌ package.json missing"
        echo ""
        echo "🎉 Build validation completed successfully!"
          
          # Test nginx and reload
          nginx -t && systemctl reload nginx
          
          echo "✅ Deployment completed!"
          
        EOF
